<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<title>结算页</title>
	<link rel="stylesheet" href="/js/bootStrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/js/shop/css/webbase.css" />
	<link rel="stylesheet" type="text/css" href="/js/shop/css/pages-getOrderInfo.css" />
</head>

<body>
<!--head-->
<div id="navDiv"></div>
<div class="cart py-container" id="orderAllInfo">
	<!--logoArea-->
	<!--<div class="logoArea">
		<div class="fl logo"><span class="title">结算页</span></div>
		<div class="fr search">
			<form class="sui-form form-inline">
				<div class="input-append">
					<input type="text" type="text" class="input-error input-xxlarge" placeholder="品优购自营" />
					<button class="sui-btn btn-xlarge btn-danger" type="button">搜索</button>
				</div>
			</form>
		</div>
	</div>-->
	<!--主内容-->
	<div class="checkout py-container">
		<div class="checkout-tit">
			<h4 class="tit-txt">填写并核对订单信息</h4>
		</div>
		<div class="checkout-steps">
			<!--收件人信息-->
			<div class="step-tit">
				<h5>收件人信息<span><a onclick="addTakeArea()" data-target=".edit" data-keyboard="false" class="newadd">新增收货地址</a></span></h5>


			</div>
			<div class="step-cont">
				<div class="addressInfo">
					<ul class="addr-detail">
						<!--所有收货地址的展示-->
						<li class="addr-item" id="takeAreaInfoDiv">


						</li>
					</ul>
					<!--添加地址-->
					<!--<div  tabindex="-1" role="dialog" data-hasfoot="false" class="sui-modal hide fade edit">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" data-dismiss="modal" aria-hidden="true" class="sui-close">×</button>
									<h4 id="myModalLabel" class="modal-title">添加收货地址</h4>
								</div>
								<div class="modal-body">
									<form action="" class="sui-form form-horizontal">
										<div class="control-group">
											<label class="control-label">收货人：</label>
											<div class="controls">
												<input type="text" class="input-medium">
											</div>
										</div>

										<div class="control-group">
											<label class="control-label">详细地址：</label>
											<div class="controls">
												<input type="text" class="input-large">
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">联系电话：</label>
											<div class="controls">
												<input type="text" class="input-medium">
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">邮箱：</label>
											<div class="controls">
												<input type="text" class="input-medium">
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">地址别名：</label>
											<div class="controls">
												<input type="text" class="input-medium">
											</div>
											<div class="othername">
												建议填写常用地址：<a href="#" class="sui-btn btn-default">家里</a>　<a href="#" class="sui-btn btn-default">父母家</a>　<a href="#" class="sui-btn btn-default">公司</a>
											</div>
										</div>

									</form>


								</div>
								<div class="modal-footer">
									<button type="button" data-ok="modal" class="sui-btn btn-primary btn-large">确定</button>
									<button type="button" data-dismiss="modal" class="sui-btn btn-default btn-large">取消</button>
								</div>
							</div>
						</div>
					</div>-->
					<!--确认地址-->
				</div>
				<div class="hr"></div>

			</div>
			<div class="hr"></div>
			<!--支付和送货-->
			<div class="payshipInfo">
				<div class="step-tit">
					<h5>支付方式</h5>
				</div>
				<div class="step-cont">
					<ul class="payType">
						<li class="selected" id="payType" value="10">微信付款<span title="点击取消选择"></span></li>
						<li>货到付款<span title="点击取消选择"></span></li>
					</ul>
				</div>
				<div class="hr"></div>
				<div class="step-tit">
					<h5>送货清单</h5>
				</div>
				<!--订单详情的div-->
				<div class="step-cont">
					<ul class="send-detail" id="orderDetailsInfoDiv">

					</ul>
				</div>
				<div class="hr"></div>
			</div>
			<div class="linkInfo">
				<div class="step-tit">
					<h5>发票信息</h5>
				</div>
				<div class="step-cont">
					<span>是否打印电子发票：
						<input type="radio" value="1" name="bill"/>是
						<input type="radio" value="2" name="bill"/>否
					</span>
				</div>
			</div>
			<div class="cardInfo">
				<div class="step-tit">
					<h5>使用优惠/抵用</h5>
				</div>
			</div>
		</div>
	</div>
	<!--总价格，总数量的div-->
	<div class="order-summary" id="orderCountInfoDiv">

	</div>
	<!--没有库存的弹框div-->
	<div id="orderInfoDiv"></div>
	<!--确认信息的div-->
	<div class="clearfix trade" id="orderConfirmInfoDiv">
		<div class="fc-receiverInfo">寄送至:<i id="allAreaInfo">##allAreaInfo##</i> 收货人:<i id="addresseeName">##addresseeName##</i> <i id="addresseePhone">##addresseePhone##</i></div>
	</div>
	<div class="submit">
		<a class="sui-btn btn-danger btn-xlarge" href="#" onclick="onpay()">提交订单</a>
	</div>
</div>
<!--订单详情的模板-->
<div id="orderDetailsModel" style="display: none">
	<li>
		<div class="sendGoods">
			<ul class="yui3-g">
				<li class="yui3-u-1-6">
					<span><img src="##image##" width="60px"/></span>
				</li>
				<li class="yui3-u-7-12">
					<div class="desc">##productName##</div>
					<div class="seven">7天无理由退货</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="price">￥##price##</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="num">X##count##</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="exit">有货</div>
				</li>
			</ul>
		</div>
	</li>
</div>
<!--没有库存的模板-->
<div id="orderDetailsModelNo" style="display: none">
	<li>
		<div class="sendGoods">
			<ul class="yui3-g">
				<li class="yui3-u-1-6">
					<span><img src="##image##" width="60px"/></span>
				</li>
				<li class="yui3-u-7-12">
					<div class="desc">##productName##</div>
					<div class="seven">7天无理由退货</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="price">￥##price##</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="num">X##count##</div>
				</li>
				<li class="yui3-u-1-12">
					<div class="exit">无货</div>
				</li>
			</ul>
		</div>
	</li>
</div>
<!--总价格，总数量模板-->
<div id="orderCountModel" style="display: none">
	<div class="static fr">
		<div class="list">
			<span><i class="number">##totalCount##</i>件商品，总商品金额</span>
			<em class="allprice">¥##totalPrice##</em>
		</div>
		<div class="list">
			<span>返现：</span>
			<em class="money">0.00</em>
		</div>
		<div class="list">
			<span>运费：</span>
			<em class="transport">0.00</em>
		</div>
	</div>
</div>

<!--确认信息模板-->
<div id="orderConfirmModel" style="display: none">
	<div class="fc-price">应付金额:　<span class="price">¥##totalPrice##</span></div>

</div>
 <!--展示收货地址的模板-->
<div id="takeAreaModel" style="display: none">
	<div class="con name ##selected##" name="redioDiv" onclick="radioClick(this ,'##id##')"><a href="javascript:;"><i >##addresseeName##</i><span title="点击取消选择">&nbsp;</a></div>
	<div class="con address" ><i>##allAreaInfo##</i><span >##addresseePhone##</span>
		<span class="edittext"><a data-toggle="modal" data-target=".edit" data-keyboard="false" onclick="updateArea('##id##')">编辑</a>&nbsp;&nbsp;<a href="javascript:;" onclick="deleteArea('##id##')">删除</a></span>
	</div>
	<div class="clearfix"></div>
</div>

<!--新增的from表单-->
<div id="addMemberAreaDiv" style="display: none">
	<form class="form-horizontal" id="addUserForm">
		<div class="form-group">
			<label class="col-sm-2 control-label">收件人:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="请输入收件人" id="add_addresseeName"  >
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label">手机号码:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="请输入手机号码" id="add_addresseePhone"  >
			</div>
		</div>
		<div class="form-group" id="addAreaSelDiv">
			<label class="col-sm-2 control-label">所在地区:</label>

		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label">详细地址:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="如:道路，门牌号，小区，楼栋号等" id="add_areaDetails" >
			</div>
		</div>
	</form>
</div>

<!--修改的from表单-->
<div id="updateMemberAreaDiv" style="display: none">
	<form class="form-horizontal" >
		<div class="form-group">
			<label class="col-sm-2 control-label">收件人:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="请输入收件人" id="update_addresseeName"  >
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label">手机号码:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="请输入手机号码" id="update_addresseePhone"  >
			</div>
		</div>
		<div class="form-group" id="updateAreaSelDiv">
			<label class="col-sm-2 control-label">所在地区:</label>

		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label">详细地址:</label>
			<div class="col-sm-10">
				<input type="text" class="form-control" placeholder="如:道路，门牌号，小区，楼栋号等" id="update_areaDetails" >
			</div>
		</div>
	</form>
</div>

<!-- 底部栏位 -->
<!--页面底部-->
<div class="clearfix footer">
	<div class="py-container">
		<div class="footlink">
			<div class="Mod-service">
				<ul class="Mod-Service-list">
					<li class="grid-service-item intro  intro1">

						<i class="serivce-item fl"></i>
						<div class="service-text">
							<h4>正品保障</h4>
							<p>正品保障，提供发票</p>
						</div>

					</li>
					<li class="grid-service-item  intro intro2">

						<i class="serivce-item fl"></i>
						<div class="service-text">
							<h4>正品保障</h4>
							<p>正品保障，提供发票</p>
						</div>

					</li>
					<li class="grid-service-item intro  intro3">

						<i class="serivce-item fl"></i>
						<div class="service-text">
							<h4>正品保障</h4>
							<p>正品保障，提供发票</p>
						</div>

					</li>
					<li class="grid-service-item  intro intro4">

						<i class="serivce-item fl"></i>
						<div class="service-text">
							<h4>正品保障</h4>
							<p>正品保障，提供发票</p>
						</div>

					</li>
					<li class="grid-service-item intro intro5">

						<i class="serivce-item fl"></i>
						<div class="service-text">
							<h4>正品保障</h4>
							<p>正品保障，提供发票</p>
						</div>

					</li>
				</ul>
			</div>
			<div class="clearfix Mod-list">
				<div class="yui3-g">
					<div class="yui3-u-1-6">
						<h4>购物指南</h4>
						<ul class="unstyled">
							<li>购物流程</li>
							<li>会员介绍</li>
							<li>生活旅行/团购</li>
							<li>常见问题</li>
							<li>购物指南</li>
						</ul>

					</div>
					<div class="yui3-u-1-6">
						<h4>配送方式</h4>
						<ul class="unstyled">
							<li>上门自提</li>
							<li>211限时达</li>
							<li>配送服务查询</li>
							<li>配送费收取标准</li>
							<li>海外配送</li>
						</ul>
					</div>
					<div class="yui3-u-1-6">
						<h4>支付方式</h4>
						<ul class="unstyled">
							<li>货到付款</li>
							<li>在线支付</li>
							<li>分期付款</li>
							<li>邮局汇款</li>
							<li>公司转账</li>
						</ul>
					</div>
					<div class="yui3-u-1-6">
						<h4>售后服务</h4>
						<ul class="unstyled">
							<li>售后政策</li>
							<li>价格保护</li>
							<li>退款说明</li>
							<li>返修/退换货</li>
							<li>取消订单</li>
						</ul>
					</div>
					<div class="yui3-u-1-6">
						<h4>特色服务</h4>
						<ul class="unstyled">
							<li>夺宝岛</li>
							<li>DIY装机</li>
							<li>延保服务</li>
							<li>品优购E卡</li>
							<li>品优购通信</li>
						</ul>
					</div>
					<div class="yui3-u-1-6">
						<h4>帮助中心</h4>
						<img src="img/wx_cz.jpg">
					</div>
				</div>
			</div>
			<div class="Mod-copyright">
				<ul class="helpLink">
					<li>关于我们<span class="space"></span></li>
					<li>联系我们<span class="space"></span></li>
					<li>关于我们<span class="space"></span></li>
					<li>商家入驻<span class="space"></span></li>
					<li>营销中心<span class="space"></span></li>
					<li>友情链接<span class="space"></span></li>
					<li>关于我们<span class="space"></span></li>
					<li>营销中心<span class="space"></span></li>
					<li>友情链接<span class="space"></span></li>
					<li>关于我们</li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!--页面底部END-->
<script src="/js/jquery-3.3.1.js"></script>
<script type="text/javascript" src="/js/shop/js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="/js/shop/js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="/js/shop/components/ui-modules/nav/nav-portal-top.js"></script>
<script type="text/javascript" src="/js/shop/js/pages/getOrderInfo.js"></script>
<script src="/js/bootStrap/js/bootstrap.min.js"></script>
<script src="/js/jquery.cookie.min.js"></script>
<script src="/js/bootbox/bootbox.min.js"></script>
<script src="/js/common/nav.js"></script>

<script>
	var v_memberAreaFrom;
	$(function () {
        initTakeArea();
        initOrder();
        backUp();
        initToke();

    })

	/*备份*/
	function backUp() {
        v_memberAreaFrom = $("#addMemberAreaDiv").html();
    }
    var v_memberArea;
    function initTakeArea() {
		$.ajax({
			url:"http://localhost:8086/memberAreas/findMemberArea",
			type:"get",
            async:false,
			success:function (result) {
				if (result.code == 200){
				    var v_dataArr = result.data;
				    console.log(v_dataArr)
                    for (var i = 0; i < v_dataArr.length; i++) {
						v_memberArea = v_dataArr[i];
						var v_memberAreaInfo = $("#takeAreaModel").html()
							.replace(/##id##/g,v_memberArea.id)
							.replace(/##addresseePhone##/g,v_memberArea.addresseePhone)
							.replace(/##addresseeName##/g,v_memberArea.addresseeName)
							.replace(/##allAreaInfo##/g,v_memberArea.allAreaInfo)
							$("#takeAreaInfoDiv").append(v_memberAreaInfo);




                        $(function(){
                            $(".address").hover(function(){
                                $(this).addClass("address-hover");
                            },function(){
                                $(this).removeClass("address-hover");
                            });
                        })

                        $(function(){
                            $(".addr-item .name").click(function(){
                                $(this).toggleClass("selected").siblings().removeClass("selected");
                            });
                            $(".payType li").click(function(){
                                $(this).toggleClass("selected").siblings().removeClass("selected");
                            });
                        })
                    }
				}
            }
		})
    }
	function initOrder() {
        if (!loginFlag) {
            $("#orderAllInfo").html("<div style='text-align: center'><h1>恁好！请先<a href='/login.html'>登陆</a>或者<a href='menberRegiste.html'>注册</a></h1></div>");
        }else {
            $.ajax({
                type: "get",
                url: "http://localhost:8086/carts",
                success: function (result) {
                    console.log(result);
                    if (result.code == 5202) {
                        $("#orderDetailsInfoDiv").html("<div style='text-align: center'><h1><a href='list.html'>请添加商品</a></h1></div>");
                    }else if (result.code == 200){
                        var v_cart = result.data;
                        var v_cartArr = v_cart.itemCart;
                        console.log(v_cartArr);
                        /*替换详细信息*/
                        //$("#cartBody").html("");
                        for (var i = 0; i < v_cartArr.length; i++) {
                            var v_cartItem = v_cartArr[i];
                            var v_cartInfo =  $("#orderDetailsModel").html().replace(/##image##/g,v_cartItem.image)
                                .replace(/##productName##/g,v_cartItem.productName)
                                .replace(/##price##/g,v_cartItem.subTotalPrice)
                                .replace(/##count##/g,v_cartItem.count)
                               /* .replace(/##subTotalPrice##/g,v_cartItem.subTotalPrice)
                                .replace(/##productId##/g,v_cartItem.productId)*/
                            $("#orderDetailsInfoDiv").append(v_cartInfo)
                        }
                        /*替换总价格总数量   模板技术*/
                        //$("#totalDiv").html("");
                        var v_cartTotal =  $("#orderCountModel").html().replace(/##totalCount##/g,v_cart.totalCount)
                            .replace(/##totalPrice##/g,v_cart.totalPrice)
                        $("#orderCountInfoDiv").append(v_cartTotal);

                        /*替换确认信息   模板技术*/
                        /*var v_orderConfirm = $("#orderConfirmModel").html()
							.replace(/##totalPrice##/g,v_cart.totalPrice)
                            .replace(/##addresseePhone##/g,v_memberArea.addresseePhone)
                           .replace(/##addresseeName##/g,v_memberArea.addresseeName)
                            .replace(/##allAreaInfo##/g,v_memberArea.allAreaInfo)
						$("#orderConfirmInfoDiv").append(v_orderConfirm);*/
                    }
                }
            })
        }
    }
    	/*删除收货地址*/
	function deleteArea(id) {

        bootbox.confirm({
            backdrop:false,
            message: "你确认要删除么?",
            buttons: {
                confirm: {
                    label: '<span class="glyphicon glyphicon-ok"></span>确认',
                    className: 'btn-success'
                },
                cancel: {
                    label: '<span class="glyphicon glyphicon-remove"></span>关闭',
                    className: 'btn-danger'
                }
            },
            callback: function (result) {
                if (result){
                    $.ajax({
                        url:"http://localhost:8086/memberAreas/"+id,
                        type:"delete",
                        success:function (result) {
                            if (result.code == 200){
								location.reload();
                            }
                        }
                    })
                }
            }
        });

    }

    /*新增收货地址*/
	var v_memberAreaAdd;
	function addTakeArea() {
        addAreaSelect(1);
        v_memberAreaAdd=  bootbox.dialog({
            title:"添加收货地址页面",
            message: $("#addMemberAreaDiv form"),
            //size:"large",
			backdrop:false,
            buttons: {
                confirm: {
                    label: "<span class='glyphicon glyphicon-ok'></span>保存",
                    className: 'btn-danger',
                    callback: function(){
                        //点击确定按钮 发送ajax请求，插入数据
						var v_add_addresseeName = $("#add_addresseeName",v_memberAreaAdd).val();
						var v_add_addresseePhone = $("#add_addresseePhone",v_memberAreaAdd).val();
						var v_add_areaDetails = $("#add_areaDetails",v_memberAreaAdd).val();
						alert(v_add_addresseeName)
                        var v_area1 = $($("select[name='areaName']",v_memberAreaAdd)[0]).val();
                        var v_area2 = $($("select[name='areaName']",v_memberAreaAdd)[1]).val();
                        var v_area3 = $($("select[name='areaName']",v_memberAreaAdd)[2]).val();

                        var v_jsonMemberArea ={};
                        v_jsonMemberArea.addresseeName = v_add_addresseeName;
                        v_jsonMemberArea.addresseePhone = v_add_addresseePhone;
                        v_jsonMemberArea.areaDetails = v_add_areaDetails;
                        v_jsonMemberArea.area1 = v_area1;
                        v_jsonMemberArea.area2 = v_area2;
                        v_jsonMemberArea.area3 = v_area3;

                        $.ajax({
                            url:"http://localhost:8086/memberAreas/addMemberArea",
                            type:"post",
                            data:v_jsonMemberArea,
                            success:function (result) {
                                if (result.code==200){
                                    alert("添加成功")
                                }
                            }
                        })
                    }
                },
                cancel: {
                    label: "<span class='glyphicon glyphicon-remove'></span>关闭",
                    className: 'btn-warning',

                },
            },
        })
         $("#addMemberAreaDiv").html(v_memberAreaFrom);

    }
    /*修改地区信息*/
	/*var v_memberAreaUpdate;
    function updateArea(id) {
        $.ajax({
            url:"http://localhost:8086/memberAreas/findMemberAreById",
			type:"get",
			data:{
                "id":id,
			},
            success:function(result){
                if(result.code==200){
                    //赋值
                    v_memberAreaUpdate =  bootbox.dialog({
                        title:"修改页面",
                        message: $("#updateMemberAreaDiv form"),
                        //size:"large",
						backdrop:false,
                        buttons: {
                            confirm: {
                                label: "<span class='glyphicon glyphicon-ok'></span>保存",
                                className: 'btn-danger',
                                callback: function(){
                                    //获取文本框的值
									var v_updavte_addresseeName = $("#update_addresseeName").val();
									var v_update_addresseePhone = $("#update_addresseePhone").val();

									var v_update_areaDetails = $("#update_areaDetails").val();
                                    var v_area = $("select[name='areaName']",v_memberAreaUpdate);
                                    var v_area1;
                                    var v_area2;
                                    var v_area3;
                                    if (v_area.length ==3 && $(v_area[2]).val() != -1){
                                        v_area1 = $($("select[name='areaName']",v_memberAreaUpdate)[0]).val();
                                        v_area2 = $($("select[name='areaName']",v_memberAreaUpdate)[1]).val();
                                        v_area3 = $($("select[name='areaName']",v_memberAreaUpdate)[2]).val();
                                    }
                                  /!* 数据转换*!/
                                    var v_jsonUpdateMemberArea={};
                                    v_jsonUpdateMemberArea.id=id;

                                    v_jsonUpdateMemberArea.area1 = v_area1;
                                    v_jsonUpdateMemberArea.area2 = v_area2;
                                    v_jsonUpdateMemberArea.area3 = v_area3;
                                    $.ajax({
                                        url:"http://localhost:8086/memberAreas/findMemberAreById",
										type:"put",
                                        data:v_jsonUpdateMemberArea,
                                        success:function (result) {
                                            if (result.code==200){
                                                alert("修改成功")
                                            }
                                        }
                                    })
                                }
                            },
                            cancel: {
                                label: "<span class='glyphicon glyphicon-remove'></span>关闭",
                                className: 'btn-warning',

                            },
                        },
                    })
                    $("#updateUserDiv").html(v_userUpdateFrom);
                    initDate();
                    findRole("update_role",'update');
                }
            }
        })
    }*/

	/*新增用到的地区三级联动*/
    function addAreaSelect(id,obj){
        if (obj){
            $(obj).parent().nextAll().remove();
        }
        $.ajax({
            url:"http://localhost:8086/areas/findCodeArea",
			type:"get",
			data:{
                "id":id,
			},
            success:function (result) {
                if(result.code == 200){
                    var v_areaArr = result.data;
                    if (v_areaArr.length == 0){
                        return "";
                    }
                    var v_select = ' <div class="col-sm-3">' +
                        '<select class="form-control" name="areaName" onchange="addAreaSelect(this.value,this)">';
                    v_select += '<option value="-1">请选择</option>';
                    for (var i = 0; i < v_areaArr.length; i++) {
                        var v_area = v_areaArr[i];
                        v_select +='<option value="'+v_area.id+'">'+v_area.areaName+'</option>';
                    }
                    v_select += '</select></div>';
                    $("#addAreaSelDiv",v_memberAreaAdd).append(v_select);
                }
            }
        })
    }

    var v_toKenHeader;
    function initToke() {
		$.ajax({
			url:"http://localhost:8086/tokens",
			type:"get",
			success:function (result) {
				if (result.code == 200){
				    v_toKenHeader = result.data;
				}
            }
		})
    }
    var v_payDataArr;
	/*提交订单按钮*/
    function onpay() {
	    var v_payType = $("#payType").val();
	    var v_allAreaInfo = $("#allAreaInfo").html();
	    var v_addresseeName = $("#addresseeName").html();
	    var v_addresseePhone = $("#addresseePhone").html();
	    var v_isBill = $("input[name='bill']:checked").val();
	    alert(v_isBill);
	    var v_jsonOrder = {};
	    v_jsonOrder.payType = v_payType;
        v_jsonOrder.addressee = v_allAreaInfo;
        v_jsonOrder.addresseeName = v_addresseeName;
        v_jsonOrder.addresseePhone = v_addresseePhone;
        v_jsonOrder.isBill = v_isBill;
                    $.ajax({
                        url:"http://localhost:8086/orders/addOrder",
                        type:"post",
                        data:v_jsonOrder,
                        beforeSend:function(xhr){
                            xhr.setRequestHeader("x_token",v_toKenHeader);
                            var cookie = $.cookie("fh_auth");
                            xhr.setRequestHeader("x_auth",cookie);
                        },
                        success:function (result) {
                            if (result.code == 200){
                               v_payDataArr = result.data;
                               console.log(v_payDataArr)
                               if (v_payDataArr.length == 0) {
                                   location.href = "pay.html";
							   }else{
                                   for (var i = 0; i < v_payDataArr.length; i++) {
                                       var v_cartInfo =  $("#orderDetailsModelNo").html().replace(/##image##/g,v_payDataArr[i].image)
                                           .replace(/##productName##/g,v_payDataArr[i].productName)
                                           .replace(/##price##/g,v_payDataArr[i].price)
                                           .replace(/##count##/g,v_payDataArr[i].count)
                                       /* .replace(/##subTotalPrice##/g,v_cartItem.subTotalPrice)
                                        .replace(/##productId##/g,v_cartItem.productId)*/
                                       $("#orderInfoDiv").append(v_cartInfo)
                                   }
                                     bootbox.dialog({
                                       title:"没有库存",
                                       message: $("#orderInfoDiv"),
                                       size:"large",
                                       backdrop:false,
                                       buttons: {
                                           confirm: {
                                               label: "<span class='glyphicon glyphicon-ok'></span>保存",
                                               className: 'btn-danger',
                                               callback: function(){
                                                   location.href = "pay.html";
											   }
                                           },
                                       },
                                   })
							   }
                            }else if (result.code == 6000){
                                bootbox.alert({
                                    size: "small",
                                    title: "提示信息",
                                    backdrop:false,
                                    message: "<span class='glyphicon glyphicon-exclamation-sign'></span>"+result.msg,
                                });
							}
                        }
                    })
    }


    function radioClick(node,id){
        setTimeout(function(){
            $("div[name='radioDiv']").each(function(){
                $(this).attr("class","con name");
            })
            $(node).attr("class","con name selected");
           $.ajax({
                url: "http://localhost:8086/memberAreas/findMemberAreById?id=" + id,
			   type:"get",
                success: function (result) {
                    if (result.code == 200) {
                        var ref = result.data;
                        var addresseePhone = ref.addresseePhone.substring(0,3) + "****" + ref.addresseePhone.substring(8);
                        $("#orderConfirmInfoDiv").html("寄送至:"+ref.allAreaInfo+" 收货人："+ref.addresseeName+" " + addresseePhone);
                    }
                }
            })
        })
    }
</script>
</body>

</html>